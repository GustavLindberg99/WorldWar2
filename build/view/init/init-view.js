import{Hex}from"../../model/mapsheet.js";import{date,dateToString}from"../../model/date.js";import InfoBubble from"../info/info-bubble.js";import HexMarker from"../markers/hex-marker.js";import{writeAllCountryNames}from"./write-all-country-names.js";var InitView;!function(e){e.drawHexGrid=async function(){if(null!==document.getElementById("hexGrid"))return;const e=document.getElementById("worldMap"),t=await(await fetch("mapsheet/world.xml")).text();e.innerHTML=t+'<g id="hexGrid"></g><g id="installations"></g>',writeAllCountryNames();const n=document.getElementById("mapsheet");window.addEventListener("click",(()=>{n.style.cursor=""})),e.onclick=e=>{if("move"===n.style.cursor)return;const t=HexMarker.hexAtPoint(e.clientX,e.clientY);null!==t&&HexMarker.onhexclick?.(t,e)},e.oncontextmenu=e=>{const t=HexMarker.hexAtPoint(e.clientX,e.clientY);null!==t&&(InfoBubble.showHexInfo(t),e.preventDefault())};const i=document.getElementById("hexGrid");for(let e=0;e<=Hex.mapWidth;e++){const t=document.createElementNS("http://www.w3.org/2000/svg","path");let n="M"+(e%2?e*Hex.hexWidth:(e+1/3)*Hex.hexWidth)+" 0";for(let t=0;t<2*Hex.mapHeight+(0===e?0:1);t++)n+=(e===Hex.mapWidth&&0===t?"m":"l")+(-1)**(e+t+1)*Hex.hexWidth/3+" "+Hex.hexHeight/2;t.setAttribute("d",n),i.appendChild(t)}for(let e=0;e<=Hex.mapHeight;e++){const t=document.createElementNS("http://www.w3.org/2000/svg","path");let n="M"+Hex.hexWidth/3+" "+e*Hex.hexHeight;for(let e=0;e<Hex.mapWidth;e++)n+="h"+2*Hex.hexWidth/3+"m"+Hex.hexWidth/3+" "+(-1)**e*Hex.hexHeight/2;t.setAttribute("d",n),i.appendChild(t)}HexMarker.drawAllCities(),HexMarker.drawResourceHexes()},e.enableButtons=function(){document.querySelector(".newGameView").style.display="none",document.getElementById("dateLabel").textContent=dateToString(date.current),document.getElementById("phases").style.display="",document.getElementById("leftPanel").style.display="",document.getElementById("mainArea").style.display=""}}(InitView||(InitView={}));export default InitView;